(function(a){a.isScrollToFixed=function(b){return a(b).data("ScrollToFixed")!==undefined};a.ScrollToFixed=function(d,h){var k=this;k.$el=a(d);k.el=d;k.$el.data("ScrollToFixed",k);var c=false;var E=k.$el;var F;var C;var B=0;var p=0;var i=-1;var e=-1;var s=null;var x;var f;function t(){E.trigger("preUnfixed.ScrollToFixed");j();E.trigger("unfixed.ScrollToFixed");e=-1;B=E.offset().top;p=E.offset().left;if(k.options.offsets){p+=(E.offset().left-E.position().left)}if(i==-1){i=p}F=E.css("position");c=true;if(k.options.bottom!=-1){E.trigger("preFixed.ScrollToFixed");v();E.trigger("fixed.ScrollToFixed")}}function m(){var G=k.options.limit;if(!G){return 0}if(typeof(G)==="function"){return G()}return G}function o(){return F==="fixed"}function w(){return F==="absolute"}function g(){return !(o()||w())}function v(){if(!o()){s.css({display:E.css("display"),width:E.outerWidth(true),height:E.outerHeight(true),"float":E.css("float")});E.css({width:E.width(),position:"fixed",top:k.options.bottom==-1?r():"",bottom:k.options.bottom==-1?"":k.options.bottom,"margin-left":"0px"});if(k.options.className){E.addClass(k.options.className)}F="fixed"}}function b(){E.css({width:E.width(),position:"absolute",top:m(),left:p,"margin-left":"0px",bottom:""});F="absolute"}function j(){if(!g()){e=-1;s.css("display","none");E.css({width:"",position:"",left:"",top:"","margin-left":""});if(k.options.className){E.removeClass(k.options.className)}F=null}}function u(G){if(G!=e){E.css("left",p-G);e=G}}function r(){return k.options.marginTop}function y(){if(!a.isScrollToFixed(E)){return}var I=c;if(!c){t()}var G=a(window).scrollLeft();var J=a(window).scrollTop();var H=m();if(k.options.minWidth&&a(window).width()<k.options.minWidth){if(!g()||!I){n();E.trigger("preUnfixed.ScrollToFixed");j();E.trigger("unfixed.ScrollToFixed")}}else{if(k.options.bottom==-1){if(H>0&&J>=H-r()){if(!w()||!I){n();E.trigger("preAbsolute.ScrollToFixed");b();E.trigger("unfixed.ScrollToFixed")}}else{if(J>=B-r()){if(!o()||!I){n();E.trigger("preFixed.ScrollToFixed");v();e=-1;E.trigger("fixed.ScrollToFixed")}u(G)}else{if(!g()||!I){n();E.trigger("preUnfixed.ScrollToFixed");j();E.trigger("unfixed.ScrollToFixed")}}}}else{if(H>0){if(J+a(window).height()-E.outerHeight(true)>=H-(r()||-l())){if(o()){n();E.trigger("preUnfixed.ScrollToFixed");if(C==="absolute"){b()}else{j()}E.trigger("unfixed.ScrollToFixed")}}else{if(!o()){n();E.trigger("preFixed.ScrollToFixed");v()}u(G);E.trigger("fixed.ScrollToFixed")}}else{u(G)}}}}function l(){if(!k.options.bottom){return 0}return k.options.bottom}function n(){var G=E.css("position");if(G=="absolute"){E.trigger("postAbsolute.ScrollToFixed")}else{if(G=="fixed"){E.trigger("postFixed.ScrollToFixed")}else{E.trigger("postUnfixed.ScrollToFixed")}}}var A=function(G){if(E.is(":visible")){c=false;y()}};var D=function(G){y()};var z=function(){var H=document.body;if(document.createElement&&H&&H.appendChild&&H.removeChild){var J=document.createElement("div");if(!J.getBoundingClientRect){return null}J.innerHTML="x";J.style.cssText="position:fixed;top:100px;";H.appendChild(J);var K=H.style.height,L=H.scrollTop;H.style.height="3000px";H.scrollTop=500;var G=J.getBoundingClientRect().top;H.style.height=K;var I=(G===100);H.removeChild(J);H.scrollTop=L;return I}return null};var q=function(G){G=G||window.event;if(G.preventDefault){G.preventDefault()}G.returnValue=false};k.init=function(){k.options=a.extend({},a.ScrollToFixed.defaultOptions,h);if(!(k.options&&k.options.dontCheckForPositionFixedSupport)){var G=z();if(!G){return}}k.$el.css("z-index",k.options.zIndex);s=a("<div />");F=E.css("position");C=E.css("position");if(g()){k.$el.after(s)}a(window).bind("resize.ScrollToFixed",A);a(window).bind("scroll.ScrollToFixed",D);if(k.options.preFixed){E.bind("preFixed.ScrollToFixed",k.options.preFixed)}if(k.options.postFixed){E.bind("postFixed.ScrollToFixed",k.options.postFixed)}if(k.options.preUnfixed){E.bind("preUnfixed.ScrollToFixed",k.options.preUnfixed)}if(k.options.postUnfixed){E.bind("postUnfixed.ScrollToFixed",k.options.postUnfixed)}if(k.options.preAbsolute){E.bind("preAbsolute.ScrollToFixed",k.options.preAbsolute)}if(k.options.postAbsolute){E.bind("postAbsolute.ScrollToFixed",k.options.postAbsolute)}if(k.options.fixed){E.bind("fixed.ScrollToFixed",k.options.fixed)}if(k.options.unfixed){E.bind("unfixed.ScrollToFixed",k.options.unfixed)}if(k.options.spacerClass){s.addClass(k.options.spacerClass)}E.bind("resize.ScrollToFixed",function(){s.height(E.height())});E.bind("scroll.ScrollToFixed",function(){E.trigger("preUnfixed.ScrollToFixed");j();E.trigger("unfixed.ScrollToFixed");y()});E.bind("detach.ScrollToFixed",function(H){q(H);E.trigger("preUnfixed.ScrollToFixed");j();E.trigger("unfixed.ScrollToFixed");a(window).unbind("resize.ScrollToFixed",A);a(window).unbind("scroll.ScrollToFixed",D);E.unbind(".ScrollToFixed");k.$el.removeData("ScrollToFixed")});A()};k.init()};a.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1000};a.fn.scrollToFixed=function(b){return this.each(function(){(new a.ScrollToFixed(this,b))})}})(jQuery);